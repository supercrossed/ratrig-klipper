
[include mainsail2.cfg]
[include HBB.cfg]
[include Orbitool.cfg]
[include LED.cfg]
[include Beacon.cfg]
[include START_END.cfg]
[include KAMP_Settings.cfg]
[include adaptivebed.cfg]
[include macro.cfg]
#[include pico.cfg]

[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32h723xx_20001A000B51313236343430-if00

[exclude_object]

[gcode_arcs]

[include timelapse.cfg]

[skew_correction]

###########################################################
####TMC AUTOTUNE####

#[autotune_tmc stepper_x]
#motor: ldo-42sth48-2804ah
#voltage:48.0
#[autotune_tmc stepper_y]
#motor: ldo-42sth48-2804ah
#voltage:48.0
#[autotune_tmc stepper_x1]
#motor: ldo-42sth48-2804ah
#voltage:48.0
#[autotune_tmc stepper_y1]
#motor: ldo-42sth48-2804ah
#voltage:48.0




#############################################################






[virtual_sdcard]
path: /home/andrei/printer_data/gcodes
on_error_gcode: CANCEL_PRINT

[printer]
kinematics: corexy
max_velocity: 1500
max_accel: 5000
square_corner_velocity: 4.0
max_z_velocity: 15
max_z_accel: 500

[force_move]
enable_force_move: True

#[temperature_sensor chamber]
#sensor_type: EPCOS 100K B57560G104F
#sensor_pin: PF7

#[filament_switch_sensor switch_sensor]
#switch_pin: ^PG12
#pause_on_runout: True
#runout_gcode:
#  PAUSE
#  M117 filament switch runout
#insert_gcode:
#  M117 Filament switch inserted

#[filament_motion_sensor encoder_sensor]
#switch_pin: ^PG13
#detection_length: 25
#extruder: extruder
#pause_on_runout: true

[fan_generic exhaust]
pin: PD14
max_power: 1.0
cycle_time: 0.0005
hardware_pwm: false
kick_start_time: 0.2



[fan_generic HEPA]
pin: PA8
max_power: 0.7
cycle_time: 0.0005
hardware_pwm: false
kick_start_time: 0.2

#[fan]
#pin:PE13
#max_power: 1.0
#cycle_time: 0.002
#hardware_pwm: false
#kick_start_time: 0.2

[controller_fan MCU_Fan]
pin: PD15
max_power:1.0
kick_start_time: 2.0
heater: heater_bed
stepper: stepper_z
fan_speed: 1.0
cycle_time: 0.001
idle_timeout: 10
idle_speed: 0

[controller_fan MCU_Fan2]
pin: PD12
max_power:1.0
kick_start_time: 2.0
heater: heater_bed
stepper: stepper_z
fan_speed: 1.0
cycle_time: 0.001
idle_timeout: 10
idle_speed: 0

[controller_fan Bed_Fan]
pin: PD13
max_power:1.0
kick_start_time: 2.0
heater: heater_bed
stepper: stepper_z
fan_speed: 1.0
cycle_time: 0.1
idle_timeout: 999999999999999999999999999999999
idle_speed: 0

[temperature_sensor mcu_temp]
sensor_type: temperature_mcu
min_temp: 0
max_temp: 100

[temperature_sensor Host]
sensor_type: temperature_host
min_temp: 0
max_temp: 100

[stepper_y]
step_pin: PF13
dir_pin: PF12
enable_pin: !PF14
microsteps: 16
rotation_distance: 40
position_endstop: -25
position_min: -25
position_max: 500
homing_speed: 60
endstop_pin: PG6
homing_retract_dist: 0

[tmc5160 stepper_y]
cs_pin: PC4
run_current: 2.5
Interpolate: false
hold_current: 1.5
stealthchop_threshold: 0
spi_bus: spi1


[stepper_x]
step_pin: PG0
dir_pin: PG1
enable_pin: !PF15
microsteps: 16
rotation_distance: 40
position_endstop: -52
position_min: -52
position_max: 530
homing_speed: 60
endstop_pin: nhk:gpio13
homing_retract_dist: 0

[tmc5160 stepper_x]
cs_pin: PD11
run_current: 2.5
Interpolate: false
hold_current: 1.5
stealthchop_threshold: 0
spi_bus: spi1

[stepper_x1]
step_pin: PC13
dir_pin: !PF0
enable_pin: !PF1
microsteps: 16
rotation_distance: 40


[tmc5160 stepper_x1]
cs_pin: PE4
run_current: 2.5
Interpolate: false
hold_current: 1.5
stealthchop_threshold: 0
spi_bus: spi1

[stepper_y1]
step_pin: PE2
dir_pin: !PE3
enable_pin: !PD4
microsteps: 16
rotation_distance: 40


[tmc5160 stepper_y1]
cs_pin: PE1
run_current: 2.5
Interpolate: false
hold_current: 1.5
stealthchop_threshold: 0
spi_bus: spi1


[stepper_z]
step_pin: PF11
dir_pin: !PG3
enable_pin: !PG5
microsteps: 16
rotation_distance: 4.0
homing_speed: 20
homing_retract_dist: 0
endstop_pin: probe:z_virtual_endstop
position_max: 520
position_min: -4


[tmc5160 stepper_z]
cs_pin:PC6
run_current: 2.2
hold_current: 2.2
stealthchop_threshold: 0
Interpolate: false
spi_bus: spi1


[stepper_z2]
step_pin: PG4
dir_pin: !PC1
enable_pin: !PA2
microsteps: 16
rotation_distance: 4.0


[tmc5160 stepper_z2]
cs_pin:PC7
run_current: 2.2
hold_current: 2.2
stealthchop_threshold: 0
spi_bus: spi1
Interpolate: false


[stepper_z1]
step_pin: PF9
dir_pin: !PF10
enable_pin: !PG2
microsteps: 16
rotation_distance: 4.0


[tmc5160 stepper_z1]
cs_pin:PF2
run_current: 2.2
hold_current: 2.2
stealthchop_threshold: 0
spi_bus: spi1
Interpolate: false

[z_tilt]
z_positions: -110,30
  615,30
  250, 605
points: 25,20
  475,20
  250, 450
retries: 5
retry_tolerance: 0.01
speed: 250

[bed_mesh]
algorithm: bicubic
mesh_pps: 0,0
bicubic_tension: 0.2
horizontal_move_z: 3
mesh_min: 20,20
mesh_max: 480,465
probe_count: 15,15
speed: 250
fade_start: 1
fade_end: 5

[heater_bed]
heater_pin: PA0
sensor_type: Generic 3950
sensor_pin: PF3
control: pid
pid_Kp: 54.027
pid_Ki: 0.770
pid_Kd: 948.182
min_temp: 0
max_temp: 150
max_power: 0.8

[heater_generic chamber]
heater_pin: PB0
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PF7
control: pid
pid_Kp: 40.0
pid_Ki: 0.2
pid_Kd: 1000.0
min_temp: 0
max_temp: 100


[verify_heater chamber]
max_error: 120
check_gain_time: 180
hysteresis: 5
heating_gain: 0.5

[controller_fan chamber_fan]
pin: PE5
max_power:1.0
kick_start_time: 2.0
heater: chamber
fan_speed: 1.0
cycle_time: 0.001
idle_timeout: 20
idle_speed: 0

[axis_twist_compensation]
speed: 50
horizontal_move_z: 5
calibrate_start_x: 20
calibrate_end_x: 470
calibrate_y: 250
calibrate_start_y: 20
calibrate_end_y: 470
calibrate_x: 250

[include AFC/*.cfg]

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [input_shaper]
#*# shaper_type_x = mzv
#*# shaper_freq_x = 61.0
#*# shaper_type_y = mzv
#*# shaper_freq_y = 32.2
#*#
#*# [beacon model default]
#*# model_coef = 1.4617228278494379,
#*# 	  1.7863354588038673,
#*# 	  0.7958804512659011,
#*# 	  0.36661499553030225,
#*# 	  0.13915602668577634,
#*# 	  0.17475328940168722,
#*# 	  0.12214490169465016,
#*# 	  0.024888773989615278,
#*# 	  0.08041740958690245,
#*# 	  0.05046854134223041
#*# model_domain = 1.826208892217451e-07,1.9384969302170083e-07
#*# model_range = 0.200000,5.000000
#*# model_temp = 49.694421
#*# model_offset = 0.00000
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	-0.101627, -0.098429, -0.097266
#*# 	-0.088209, -0.087071, -0.084696
#*# 	-0.071060, -0.067086, -0.066224
#*# x_count = 3
#*# y_count = 3
#*# mesh_x_pps = 0
#*# mesh_y_pps = 0
#*# algo = direct
#*# tension = 0.1
#*# min_x = 163.093
#*# max_x = 197.093
#*# min_y = 123.499
#*# max_y = 157.499
#*#
#*# [axis_twist_compensation]
#*# z_compensations = 0.009911, 0.010642, -0.020553
#*# compensation_start_x = 20.0
#*# compensation_end_x = 470.0
#*# zy_compensations = -0.019867, -0.000564, 0.020431
#*# compensation_start_y = 20.0
#*# compensation_end_y = 470.0
